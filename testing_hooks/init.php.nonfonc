<?php


	function testecrit($chaine,$dossier) {
	
				$nom = $dossier."epubTest.txt";
   
                 $fp = fopen($nom, "w");
                  fputs($fp, $chaine."\n");
                  fclose($fp);
	}

class Essai extends Plugin {//implements IHandler {

	private $host;
	private $cache_dir;

/*	
	function csrf_ignore($method) {
		return false;
	}

	function before($method) {
		return true;
	}

	function after() {
		return true;
	}
*/

	function about() {
		return array(1.0,
			"essaie de faire tourner une fonction periodiquement",
			"elenzar");/*,
			true);*/
	}

	function init($host) {
		$this->host = $host;

		$this->cache_dir = CACHE_DIR . "/essaiEpub/";

		if (!is_dir($this->cache_dir)) {
			mkdir($this->cache_dir);
		
		if (is_dir($this->cache_dir)) {

			if (!is_writable($this->cache_dir)) {
				chmod($this->cache_dir, 0777);}

			if (is_writable($this->cache_dir)) {
				$host->add_hook($host::HOOK_UPDATE_TASK, $this);

				testEcrit("marqueur#1yepee",$this->cache_dir);	
			} else {
				user_error("Starred cache directory is not writable.", E_USER_WARNING);
				testEcrit("marqueur#2",$this->cache_dir);	
	}

		} else {
			user_error("Unable to create starred cache directory.", E_USER_WARNING);
			testEcrit("marqeur#3",$this->cache_dir);	
		}
	}




	function hook_update_task() {
		$fp = fopen($this->cache_dir . "essaiepub.txt","w");
		fputs($fp,"update_task");
		fclose($fp);
	}


	function api_version() {
		return 2;
	}
}
?>
